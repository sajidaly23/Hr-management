"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={1185:e=>{e.exports=require("mongoose")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},6171:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>w,originalPathname:()=>_,patchFetch:()=>q,requestAsyncStorage:()=>S,routeModule:()=>y,serverHooks:()=>O,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>R});var n={};t.r(n),t.d(n,{POST:()=>v,runtime:()=>g});var o=t(884),s=t(6132),a=t(1040),i=t(5798),l=t(2421),u=t.n(l),c=t(6721),m=t.n(c),d=t(9919),p=t(8572);let g="nodejs",h=process.env.JWT_SECRET||"dev-secret-key",f=process.env.JWT_EXPIRES_IN||"7d";async function v(e){try{await (0,d.u)();let r=await e.json(),{name:t,email:n,password:o,role:s}=r||{};if(!t||!n||!o)return i.Z.json({success:!1,message:"Name, email and password are required"},{status:400});let a=await p.n.findOne({email:n});if(a)return i.Z.json({success:!1,message:"Email already in use"},{status:409});let l=await u().hash(o,10),c="employee";if("super_admin"===s){let e=await p.n.findOne({role:"super_admin"});e||(c="super_admin")}else("admin"===s||"employee"===s)&&(c=s);let g=await p.n.create({name:t,email:n,passwordHash:l,role:c}),v=function(e){let r={id:e.id,email:e.email,role:e.role};return m().sign(r,h,{expiresIn:f})}({id:g.id,email:g.email,role:g.role});return i.Z.json({success:!0,data:{token:v,user:g.toSafeObject()}},{status:201})}catch(r){console.error("Register error",r);let e="Internal server error";return"MongooseServerSelectionError"===r.name||r.message?.includes("ECONNREFUSED")?(e="Database connection failed. Please check your MongoDB configuration in .env.local",console.error("MongoDB connection error - is MongoDB running or is MONGODB_URI correct?")):r.message&&(e=r.message),i.Z.json({success:!1,message:e},{status:500})}}let y=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"D:\\backend-1stproject\\HR-management\\front end\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:S,staticGenerationAsyncStorage:x,serverHooks:O,headerHooks:w,staticGenerationBailout:R}=y,_="/api/auth/register/route";function q(){return(0,a.patchFetch)({serverHooks:O,staticGenerationAsyncStorage:x})}},9919:(e,r,t)=>{t.d(r,{u:()=>i});var n=t(1185),o=t.n(n);let s=process.env.MONGODB_URI||"mongodb://localhost:27017/hr_management";if((s.includes("username:password")||s.includes("cluster0.xxxxx"))&&(console.error("⚠️  ERROR: MongoDB URI is still using placeholder values!"),console.error("Please update .env.local with your actual MongoDB Atlas connection string."),console.error("See MONGODB_SETUP.md for instructions.")),!s)throw Error("Please define the MONGODB_URI environment variable in .env.local");let a=global.mongoose;async function i(){return a.conn||(a.promise||(a.promise=o().connect(s).then(e=>e)),a.conn=await a.promise),a.conn}a||(a=global.mongoose={conn:null,promise:null})},8572:(e,r,t)=>{t.d(r,{n:()=>a});var n=t(1185),o=t.n(n);let s=new n.Schema({name:{type:String,required:!0},email:{type:String,required:!0,unique:!0,lowercase:!0,trim:!0},passwordHash:{type:String,required:!0},role:{type:String,enum:["super_admin","admin","employee"],default:"employee"},isActive:{type:Boolean,default:!0}},{timestamps:!0});s.methods.toSafeObject=function(){return{id:this._id.toString(),name:this.name,email:this.email,role:this.role,isActive:this.isActive}};let a=o().models.User||o().model("User",s)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[271,910],()=>t(6171));module.exports=n})();